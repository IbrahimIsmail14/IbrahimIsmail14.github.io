<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta name="google-adsense-account" content="ca-pub-3006614855562533">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6MV5MKYY1H"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-6MV5MKYY1H');
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Complete Quran Explorer - Read, listen, and understand the Holy Quran with translations, tafsir, recitations, daily prayers, Islamic knowledge, and accurate prayer times.">
    <meta name="keywords" content="Quran, Islam, Muslim, Arabic, translation, tafsir, recitation, prayer times, salah, dua, Islamic knowledge">
    <title>Quran Explorer - Complete Islamic Resource: Quran, Tafsir, Prayers & Knowledge</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3006614855562533" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic&family=Amiri&family=Scheherazade&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0d9488;
            --primary-light: #14b8a6;
            --primary-dark: #0f766e;
            --secondary: #0891b2;
            --light: #f8fafc;
            --dark: #0f172a;
            --text-light: #64748b;
            --text-dark: #1e293b;
            --card-light: #ffffff;
            --card-dark: #1e293b;
            --transition: all 0.3s ease;
            --gold: #d4af37;
            --light-gold: #f0e6c2;
            --accent: #8b5cf6;
            --play-btn: #10b981;
            --pause-btn: #f59e0b;
            --repeat-btn: #8b5cf6;
            --stop-btn: #dc2626;
            --success: #059669;
            --warning: #d97706;
            --error: #dc2626;
            --info: #0ea5e9;
            --fajr: #6366f1;
            --sunrise: #f59e0b;
            --dhuhr: #10b981;
            --asr: #0ea5e9;
            --maghrib: #d97706;
            --isha: #7c3aed;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #e0f2fe 0%, #f0fdfa 100%);
            color: var(--text-dark);
            margin: 0;
            padding: 0;
            transition: var(--transition);
            min-height: 100vh;
            background-attachment: fixed;
            background-size: cover;
            line-height: 1.6;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 10% 20%, rgba(13, 148, 136, 0.05) 0%, rgba(8, 145, 178, 0.05) 90%);
            z-index: -1;
        }

        .dark {
            background: linear-gradient(135deg, #0c4a6e 0%, #164e63 100%);
            color: #e2e8f0;
        }

        .dark::before {
            background: radial-gradient(circle at 10% 20%, rgba(13, 148, 136, 0.1) 0%, rgba(8, 145, 178, 0.1) 90%);
        }

        /* Header & Navigation */
        .sticky-top {
            position: sticky;
            top: 0;
            z-index: 100;
            background: inherit;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        header {
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 1.5rem 1rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            border-bottom: 4px solid var(--gold);
        }

        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text x="10" y="50" font-family="Noto Naskh Arabic" font-size="28" fill="rgba(255,255,255,0.1)" transform="rotate(-30)">﷽</text></svg>');
            opacity: 0.3;
        }

        .header-content {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2.5rem;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        h1 i {
            color: var(--gold);
            text-shadow: 0 0 8px rgba(212, 175, 55, 0.6);
        }

        .header-controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 0.5rem;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
            font-weight: 500;
            backdrop-filter: blur(5px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        /* Main Navigation */
        .main-nav {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            flex-wrap: wrap;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            max-width: 1200px;
            margin: 0 auto;
        }

        .dark .main-nav {
            background: rgba(15, 23, 42, 0.95);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .nav-btn {
            padding: 0.8rem 1.5rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 12px;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .nav-btn:hover {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .nav-btn.active {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1), 0 3px 6px rgba(0,0,0,0.1);
        }

        /* Content Sections */
        .content-section {
            display: none;
            padding: 2rem 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .content-section.active {
            display: block;
        }

        .section-header {
            text-align: center;
            margin-bottom: 2.5rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 12px 30px rgba(13, 148, 136, 0.3);
            position: relative;
            overflow: hidden;
        }

        .section-header h2 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 2;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .section-header p {
            position: relative;
            z-index: 2;
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* Global Audio Player */
        .global-audio-player {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--card-light);
            border-top: 3px solid var(--primary);
            padding: 1rem;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
            z-index: 1000;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .global-audio-player.show {
            transform: translateY(0);
        }

        .dark .global-audio-player {
            background: var(--card-dark);
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .player-info {
            flex: 1;
            min-width: 0;
        }

        .player-surah-name {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player-ayah-info {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .player-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .player-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
        }

        .play-btn {
            background: var(--play-btn);
            color: white;
        }

        .pause-btn {
            background: var(--pause-btn);
            color: white;
        }

        .stop-btn {
            background: var(--stop-btn);
            color: white;
        }

        .repeat-btn {
            background: var(--repeat-btn);
            color: white;
        }

        .repeat-btn.active {
            box-shadow: 0 0 0 2px white, 0 0 0 4px var(--repeat-btn);
        }

        .player-progress {
            flex: 2;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .progress-bar {
            flex: 1;
            height: 6px;
            background: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
            cursor: pointer;
        }

        .dark .progress-bar {
            background: #334155;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            width: 0%;
            transition: width 0.1s ease;
        }

        .player-time {
            font-size: 0.9rem;
            color: var(--text-light);
            min-width: 80px;
            text-align: center;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .volume-slider {
            width: 80px;
            height: 4px;
            background: #e2e8f0;
            border-radius: 2px;
            outline: none;
            cursor: pointer;
        }

        .dark .volume-slider {
            background: #334155;
        }

        /* Quran Section */
        .surah-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .surah-card {
            background: var(--card-light);
            border-radius: 18px;
            padding: 1.8rem;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.05);
            cursor: pointer;
        }

        .dark .surah-card {
            background: var(--card-dark);
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255,255,255,0.05);
        }

        .surah-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .surah-card::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            opacity: 0.8;
        }

        .surah-number {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: linear-gradient(135deg, var(--gold) 0%, #b8860b 100%);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            z-index: 2;
            border: 2px solid white;
        }

        .surah-name {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary-dark);
        }

        .dark .surah-name {
            color: var(--primary-light);
        }

        .surah-name-arabic {
            font-family: 'Noto Naskh Arabic', serif;
            font-size: 2rem;
            margin: 1rem 0;
            direction: rtl;
            color: var(--text-dark);
        }

        .dark .surah-name-arabic {
            color: #e2e8f0;
        }

        .surah-meta {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
            font-size: 0.9rem;
            color: var(--text-light);
        }

        /* Ayah Display */
        .ayah-card {
            background: var(--card-light);
            border-radius: 18px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .dark .ayah-card {
            background: var(--card-dark);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255,255,255,0.05);
        }

        .ayah-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
        }

        .ayah-card.current-playing {
            border: 2px solid var(--primary);
            box-shadow: 0 0 20px rgba(13, 148, 136, 0.3);
            transform: scale(1.02);
        }

        .ayah-card::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            opacity: 0.8;
        }

        .ayah-number {
            position: absolute;
            top: 1.5rem;
            left: 1.5rem;
            background: linear-gradient(135deg, var(--gold) 0%, #b8860b 100%);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            z-index: 2;
            border: 2px solid white;
        }

        .ayah {
            font-family: 'Noto Naskh Arabic', serif;
            font-size: 2rem;
            margin: 2rem 0 0 0;
            direction: rtl;
            text-align: right;
            line-height: 1.8;
            color: var(--text-dark);
            letter-spacing: 1px;
            position: relative;
            padding: 0 2rem;
        }

        .ayah::before {
            content: "﴾";
            position: absolute;
            top: -0.5rem;
            right: 0;
            font-size: 2.5rem;
            color: var(--gold);
            opacity: 0.6;
        }

        .ayah::after {
            content: "﴿";
            position: absolute;
            bottom: -1.5rem;
            left: 0;
            font-size: 2.5rem;
            color: var(--gold);
            opacity: 0.6;
        }

        .dark .ayah {
            color: #e2e8f0;
        }

        .translation {
            font-size: 1.2rem;
            margin: 2rem 0;
            line-height: 1.7;
            color: var(--text-dark);
            padding: 0 2rem;
            font-style: italic;
        }

        .dark .translation {
            color: #e2e8f0;
        }

        /* Playback Controls */
        .playback-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 2rem auto;
            flex-wrap: wrap;
        }

        .playback-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: var(--transition);
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .play-all-btn {
            background: linear-gradient(135deg, var(--play-btn) 0%, #059669 100%);
            color: white;
        }

        .pause-all-btn {
            background: linear-gradient(135deg, var(--pause-btn) 0%, #d97706 100%);
            color: white;
        }

        .stop-all-btn {
            background: linear-gradient(135deg, var(--stop-btn) 0%, #b91c1c 100%);
            color: white;
        }

        .repeat-btn-control {
            background: linear-gradient(135deg, var(--repeat-btn) 0%, #7c3aed 100%);
            color: white;
        }

        .repeat-btn-control.active {
            box-shadow: 0 0 0 3px white, 0 0 0 6px var(--repeat-btn);
        }

        .playback-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .playback-btn:active {
            transform: translateY(1px);
        }

        /* Individual Ayah Controls */
        .ayah-controls {
            display: flex;
            gap: 0.5rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .ayah-control-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--primary);
            background: transparent;
            color: var(--primary);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .dark .ayah-control-btn {
            border-color: var(--primary-light);
            color: var(--primary-light);
        }

        .ayah-control-btn:hover {
            background: var(--primary);
            color: white;
        }

        .dark .ayah-control-btn:hover {
            background: var(--primary-light);
            color: var(--dark);
        }

        /* Audio Player */
        audio {
            width: 100%;
            margin: 1.5rem 0;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            border: 1px solid rgba(0,0,0,0.05);
        }

        audio::-webkit-media-controls-panel {
            background: var(--card-light);
            border-radius: 12px;
        }

        .dark audio::-webkit-media-controls-panel {
            background: #1e293b;
        }

        /* Tafsir Section */
        .tafsir-container {
            margin-top: 1.5rem;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            background: #f8fafc;
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        .dark .tafsir-container {
            background: #1e293b;
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        .tafsir-header {
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            color: white;
            padding: 1rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }
        
        .tafsir-header:hover {
            background: linear-gradient(to right, var(--primary-dark), var(--primary));
        }
        
        .tafsir-content {
            background: #f1f5f9;
            padding: 1.5rem;
            line-height: 1.7;
            color: var(--text-light);
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }
        
        .dark .tafsir-content {
            background: #1e293b;
            color: #94a3b8;
        }
        
        .tafsir-content.expanded {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .tafsir-toggle {
            transition: transform 0.3s ease;
            font-size: 1.2rem;
        }
        
        .tafsir-toggle.expanded {
            transform: rotate(180deg);
        }

        /* Prayer Times Section */
        .prayer-times-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .prayer-card {
            background: var(--card-light);
            border-radius: 18px;
            padding: 2rem;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.05);
            text-align: center;
        }

        .dark .prayer-card {
            background: var(--card-dark);
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255,255,255,0.05);
        }

        .prayer-card.current {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .prayer-card::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            opacity: 0.8;
        }

        .prayer-card.fajr::after { background: var(--fajr); }
        .prayer-card.sunrise::after { background: var(--sunrise); }
        .prayer-card.dhuhr::after { background: var(--dhuhr); }
        .prayer-card.asr::after { background: var(--asr); }
        .prayer-card.maghrib::after { background: var(--maghrib); }
        .prayer-card.isha::after { background: var(--isha); }

        .prayer-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .prayer-card.fajr .prayer-icon { color: var(--fajr); }
        .prayer-card.sunrise .prayer-icon { color: var(--sunrise); }
        .prayer-card.dhuhr .prayer-icon { color: var(--dhuhr); }
        .prayer-card.asr .prayer-icon { color: var(--asr); }
        .prayer-card.maghrib .prayer-icon { color: var(--maghrib); }
        .prayer-card.isha .prayer-icon { color: var(--isha); }

        .prayer-name {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .prayer-time {
            font-size: 2rem;
            font-weight: 700;
            margin: 1rem 0;
        }

        .prayer-next {
            background: rgba(13, 148, 136, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.9rem;
            color: var(--primary);
            display: inline-block;
        }

        .dark .prayer-next {
            background: rgba(13, 148, 136, 0.15);
            color: var(--primary-light);
        }

        .countdown {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            margin-top: 0.5rem;
        }

        .dark .countdown {
            color: var(--primary-light);
        }

        .location-info {
            background: var(--card-light);
            border-radius: 18px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0,0,0,0.05);
        }

        .dark .location-info {
            background: var(--card-dark);
            border: 1px solid rgba(255,255,255,0.05);
        }

        /* Dua Section */
        .duas-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        .dua-category {
            margin-top: 2rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--primary);
            color: var(--primary-dark);
            font-size: 1.5rem;
            font-weight: 600;
            grid-column: 1 / -1;
        }
        
        .dark .dua-category {
            color: var(--primary-light);
            border-bottom-color: var(--primary-light);
        }
        
        .dua-card {
            background: var(--card-light);
            border-radius: 18px;
            padding: 1.8rem;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        .dark .dua-card {
            background: var(--card-dark);
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        .dua-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .dua-card::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--gold), var(--light-gold));
            opacity: 0.8;
        }
        
        .dua-title {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: var(--primary-dark);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }
        
        .dark .dua-title {
            color: var(--primary-light);
        }
        
        .dua-title i {
            color: var(--gold);
        }
        
        .dua-arabic {
            font-family: 'Noto Naskh Arabic', serif;
            font-size: 1.8rem;
            margin: 1rem 0;
            direction: rtl;
            text-align: right;
            line-height: 1.8;
            color: var(--text-dark);
            letter-spacing: 1px;
            position: relative;
            padding: 0 1rem;
        }
        
        .dark .dua-arabic {
            color: #e2e8f0;
        }
        
        .dua-translation {
            font-size: 1.1rem;
            margin: 1.5rem 0;
            line-height: 1.6;
            color: var(--text-dark);
            padding: 0 1rem;
            font-style: italic;
        }
        
        .dark .dua-translation {
            color: #e2e8f0;
        }
        
        .dua-reference {
            margin-top: 1.5rem;
            padding: 0.8rem;
            background: rgba(13, 148, 136, 0.1);
            border-radius: 10px;
            font-size: 0.9rem;
            color: var(--primary-dark);
            border-left: 3px solid var(--primary);
        }
        
        .dark .dua-reference {
            background: rgba(13, 148, 136, 0.15);
            color: var(--primary-light);
            border-left-color: var(--primary-light);
        }

        /* Knowledge Section */
        .knowledge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .knowledge-card {
            background: var(--card-light);
            border-radius: 18px;
            padding: 2rem;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .dark .knowledge-card {
            background: var(--card-dark);
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255,255,255,0.05);
        }

        .knowledge-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .knowledge-card::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            opacity: 0.8;
        }

        .knowledge-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 1rem;
            text-align: center;
        }

        .knowledge-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary-dark);
            text-align: center;
        }

        .dark .knowledge-title {
            color: var(--primary-light);
        }

        .knowledge-content {
            line-height: 1.7;
            color: var(--text-dark);
        }

        .dark .knowledge-content {
            color: #e2e8f0;
        }

        .knowledge-list {
            list-style: none;
            padding: 0;
        }

        .knowledge-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .dark .knowledge-list li {
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .knowledge-list li:last-child {
            border-bottom: none;
        }

        .knowledge-list i {
            color: var(--primary);
        }

        /* Search & Filters */
        .search-container {
            display: flex;
            justify-content: center;
            margin: 2rem auto;
            max-width: 600px;
            gap: 1rem;
        }
        
        .search-input {
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            border: 1px solid #cbd5e1;
            background: var(--card-light);
            color: var(--text-dark);
            font-size: 1rem;
            width: 100%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: var(--transition);
            font-family: 'Poppins', sans-serif;
        }
        
        .dark .search-input {
            background: var(--card-dark);
            border-color: #334155;
            color: #e2e8f0;
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(13, 148, 136, 0.3);
        }

        /* Settings Panel */
        .settings-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 380px;
            height: 100vh;
            background: var(--card-light);
            box-shadow: -5px 0 20px rgba(0,0,0,0.1);
            padding: 2rem;
            overflow-y: auto;
            transition: var(--transition);
            z-index: 1000;
        }

        .dark .settings-panel {
            background: var(--card-dark);
        }

        .settings-panel.open {
            right: 0;
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .dark .settings-header {
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .settings-option {
            margin-bottom: 1.5rem;
        }

        .settings-option label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .settings-option select, .settings-option input {
            width: 100%;
            padding: 0.8rem;
            border-radius: 8px;
            border: 1px solid #cbd5e1;
            background: var(--card-light);
            color: var(--text-dark);
            font-family: 'Poppins', sans-serif;
        }

        .dark .settings-option select, .dark .settings-option input {
            background: var(--card-dark);
            border-color: #334155;
            color: #e2e8f0;
        }

        /* Utility Classes */
        .loading::after {
            content: ' ⏳';
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-spinner {
            display: inline-block;
            width: 1.2rem;
            height: 1.2rem;
            border: 3px solid rgba(13, 148, 136, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
            margin-right: 0.5rem;
        }

        .floating-icon {
            position: fixed;
            bottom: 80px;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
            cursor: pointer;
            z-index: 1000;
            transition: var(--transition);
        }

        .floating-icon:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .footer {
            text-align: center;
            padding: 2rem 1.5rem;
            color: var(--text-light);
            font-size: 0.95rem;
            border-top: 1px solid rgba(0, 0, 0, 0.05);
            max-width: 1200px;
            margin: 2rem auto 0;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(5px);
        }

        .dark .footer {
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            color: #94a3b8;
            background: rgba(15, 23, 42, 0.9);
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: var(--card-light);
            color: var(--text-dark);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 0.8rem;
            z-index: 1000;
            transition: var(--transition);
            opacity: 0;
            visibility: hidden;
        }

        .dark .toast {
            background: var(--card-dark);
            color: #e2e8f0;
        }

        .toast.show {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-10px);
        }

        .toast.success {
            border-left: 4px solid var(--success);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .main-nav {
                gap: 0.5rem;
                padding: 0.8rem;
            }
            
            .nav-btn {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }
            
            .section-header h2 {
                font-size: 2rem;
            }
            
            .surah-grid, .duas-container, .knowledge-grid, .prayer-times-container {
                grid-template-columns: 1fr;
            }
            
            .ayah {
                font-size: 1.8rem;
            }
            
            .search-container {
                flex-direction: column;
            }
            
            .floating-icon {
                bottom: 70px;
                right: 1.5rem;
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
            
            .settings-panel {
                width: 100%;
                right: -100%;
            }
            
            .global-audio-player {
                padding: 0.8rem;
            }
            
            .player-controls {
                flex-direction: column;
                gap: 0.8rem;
            }
            
            .player-progress {
                width: 100%;
            }
            
            .playback-controls {
                gap: 0.5rem;
            }
            
            .playback-btn {
                padding: 0.8rem 1.5rem;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .control-btn span {
                display: none;
            }
            
            .control-btn {
                padding: 0.6rem;
            }
            
            .ayah {
                font-size: 1.6rem;
                padding: 0 1rem;
            }
            
            .translation {
                font-size: 1.1rem;
                padding: 0 1rem;
            }
            
            .surah-card, .ayah-card, .dua-card, .knowledge-card, .prayer-card {
                padding: 1.5rem 1.2rem;
            }
            
            .ayah-number, .surah-number {
                top: 1rem;
                left: 1rem;
                width: 36px;
                height: 36px;
            }
            
            .dua-arabic {
                font-size: 1.6rem;
            }
            
            .prayer-time {
                font-size: 1.5rem;
            }
            
            .playback-btn {
                padding: 0.7rem 1.2rem;
                font-size: 0.9rem;
            }
            
            .player-btn {
                width: 35px;
                height: 35px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- Global Audio Player -->
    <div class="global-audio-player" id="globalAudioPlayer">
        <div class="player-controls">
            <div class="player-info">
                <div class="player-surah-name" id="playerSurahName">Select a surah to play</div>
                <div class="player-ayah-info" id="playerAyahInfo">-</div>
            </div>
            
            <div class="player-buttons">
                <button class="player-btn repeat-btn" id="repeatBtn" title="Repeat">
                    <i class="fas fa-redo"></i>
                </button>
                <button class="player-btn stop-btn" onclick="stopPlayback()" title="Stop">
                    <i class="fas fa-stop"></i>
                </button>
                <button class="player-btn pause-btn" onclick="pausePlayback()" id="pauseBtn" title="Pause" style="display: none;">
                    <i class="fas fa-pause"></i>
                </button>
                <button class="player-btn play-btn" onclick="resumePlayback()" id="playBtn" title="Play">
                    <i class="fas fa-play"></i>
                </button>
            </div>
            
            <div class="player-progress">
                <div class="player-time" id="currentTime">0:00</div>
                <div class="progress-bar" onclick="seekAudio(event)" id="progressBar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="player-time" id="durationTime">0:00</div>
            </div>
            
            <div class="volume-control">
                <i class="fas fa-volume-up"></i>
                <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.1" value="1">
            </div>
        </div>
    </div>

    <div class="sticky-top">
        <header>
            <div class="header-content">
                <h1><i class="fas fa-book-quran"></i> Quran Explorer</h1>
                <p class="tagline">Your Complete Islamic Resource</p>
                <div class="header-controls">
                    <button class="control-btn" onclick="toggleNightMode()">
                        <i class="fas fa-moon"></i> <span>Night Mode</span>
                    </button>
                    <button class="control-btn" onclick="scrollToTop()">
                        <i class="fas fa-arrow-up"></i> <span>Top</span>
                    </button>
                    <button class="control-btn" onclick="toggleSettings()">
                        <i class="fas fa-cog"></i> <span>Settings</span>
                    </button>
                </div>
            </div>
        </header>

        <nav class="main-nav">
            <button class="nav-btn active" onclick="showSection('quran')">
                <i class="fas fa-book-quran"></i> Quran
            </button>
            <button class="nav-btn" onclick="showSection('prayer-times')">
                <i class="fas fa-clock"></i> Prayer Times
            </button>
            <button class="nav-btn" onclick="showSection('duas')">
                <i class="fas fa-hands-praying"></i> Daily Duas
            </button>
            <button class="nav-btn" onclick="showSection('knowledge')">
                <i class="fas fa-graduation-cap"></i> Islamic Knowledge
            </button>
            <button class="nav-btn" onclick="showSection('about')">
                <i class="fas fa-info-circle"></i> About
            </button>
        </nav>
    </div>

    <!-- Quran Section -->
    <section id="quran" class="content-section active">
        <div class="section-header">
            <h2>The Holy Quran</h2>
            <p>Read, listen and understand the words of Allah</p>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" id="surahSearch" placeholder="Search surahs by name...">
            <select class="search-input" id="reciterSelector" style="max-width: 250px;">
                <option value="ar.alafasy">Mishary Alafasy</option>
                <option value="ar.hudhaify">Imam Hudhaify</option>
                <option value="ar.sudais">Abdurrahman As-Sudais</option>
                <option value="ar.abdulsamad">Abdul Samad</option>
                <option value="ar.mahermuaiqly">Maher Al Muaiqly</option>
            </select>
        </div>

        <div class="playback-controls">
            <button class="playback-btn play-all-btn" onclick="playEntireSurah()">
                <i class="fas fa-play"></i> Play Entire Surah
            </button>
            <button class="playback-btn pause-all-btn" onclick="pausePlayback()" id="pauseAllBtn">
                <i class="fas fa-pause"></i> Pause
            </button>
            <button class="playback-btn stop-all-btn" onclick="stopPlayback()">
                <i class="fas fa-stop"></i> Stop
            </button>
            <button class="playback-btn repeat-btn-control" onclick="toggleRepeat()" id="repeatControlBtn">
                <i class="fas fa-redo"></i> Repeat: Off
            </button>
        </div>

        <div class="surah-grid" id="surahGrid">
            <!-- Surah cards will be loaded here -->
        </div>

        <div id="surahDetail" style="display: none;">
            <!-- Detailed surah view will be loaded here -->
        </div>
    </section>

    <!-- Prayer Times Section -->
    <section id="prayer-times" class="content-section">
        <div class="section-header">
            <h2>Prayer Times</h2>
            <p>Accurate prayer times based on your location</p>
        </div>

        <div class="location-info" id="locationInfo">
            <div class="loading">Detecting your location... <span class="loading-spinner"></span></div>
        </div>

        <div class="prayer-times-container" id="prayerTimesContainer">
            <!-- Prayer times will be loaded here -->
        </div>

        <div class="knowledge-card" style="max-width: 800px; margin: 2rem auto;">
            <h3 class="knowledge-title">Prayer Times Information</h3>
            <div class="knowledge-content">
                <p>Prayer times are calculated based on your geographical location using the <strong>Islamic Society of North America (ISNA)</strong> calculation method. Times are automatically adjusted for your timezone and daylight saving time.</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1.5rem;">
                    <div>
                        <strong>Calculation Method:</strong> ISNA
                    </div>
                    <div>
                        <strong>Juristic Method:</strong> Standard (Shafi, Maliki, Hanbali)
                    </div>
                    <div>
                        <strong>Adjustments:</strong> Auto timezone
                    </div>
                </div>
                
                <p style="margin-top: 1rem; font-size: 0.9rem; color: var(--text-light);">
                    <i class="fas fa-info-circle"></i> For the most accurate prayer times, especially for Fajr and Isha, please consult your local mosque.
                </p>
            </div>
        </div>
    </section>

    <!-- Duas Section -->
    <section id="duas" class="content-section">
        <div class="section-header">
            <h2>Daily Duas & Supplications</h2>
            <p>Authentic prayers from Quran and Sunnah for every occasion</p>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" id="duaSearch" placeholder="Search duas...">
        </div>

        <div class="duas-container" id="duasContainer">
            <!-- Duas will be loaded here -->
        </div>
    </section>

    <!-- Islamic Knowledge Section -->
    <section id="knowledge" class="content-section">
        <div class="section-header">
            <h2>Islamic Knowledge</h2>
            <p>Learn about Islam, pillars, history and teachings</p>
        </div>

        <div class="knowledge-grid">
            <div class="knowledge-card">
                <div class="knowledge-icon">
                    <i class="fas fa-mosque"></i>
                </div>
                <h3 class="knowledge-title">Five Pillars of Islam</h3>
                <div class="knowledge-content">
                    <ul class="knowledge-list">
                        <li><i class="fas fa-check"></i> Shahada (Declaration of Faith)</li>
                        <li><i class="fas fa-check"></i> Salah (Five Daily Prayers)</li>
                        <li><i class="fas fa-check"></i> Zakat (Obligatory Charity)</li>
                        <li><i class="fas fa-check"></i> Sawm (Fasting in Ramadan)</li>
                        <li><i class="fas fa-check"></i> Hajj (Pilgrimage to Mecca)</li>
                    </ul>
                </div>
            </div>

            <div class="knowledge-card">
                <div class="knowledge-icon">
                    <i class="fas fa-star-and-crescent"></i>
                </div>
                <h3 class="knowledge-title">Articles of Faith</h3>
                <div class="knowledge-content">
                    <ul class="knowledge-list">
                        <li><i class="fas fa-check"></i> Belief in One God (Allah)</li>
                        <li><i class="fas fa-check"></i> Belief in Angels</li>
                        <li><i class="fas fa-check"></i> Belief in Divine Books</li>
                        <li><i class="fas fa-check"></i> Belief in Prophets</li>
                        <li><i class="fas fa-check"></i> Belief in Day of Judgment</li>
                        <li><i class="fas fa-check"></i> Belief in Divine Decree</li>
                    </ul>
                </div>
            </div>

            <div class="knowledge-card">
                <div class="knowledge-icon">
                    <i class="fas fa-history"></i>
                </div>
                <h3 class="knowledge-title">Islamic History</h3>
                <div class="knowledge-content">
                    <p>Explore the rich history of Islam from the time of Prophet Muhammad (PBUH) to the modern era. Learn about the Rashidun Caliphs, Islamic civilization's golden age, and contributions to science, mathematics, medicine, and philosophy that shaped the modern world.</p>
                </div>
            </div>

            <div class="knowledge-card">
                <div class="knowledge-icon">
                    <i class="fas fa-balance-scale"></i>
                </div>
                <h3 class="knowledge-title">Islamic Law & Ethics</h3>
                <div class="knowledge-content">
                    <p>Understand the principles of Sharia law, Islamic jurisprudence (Fiqh), and the ethical framework that guides Muslim life. Learn about halal and haram, business ethics, family law, social responsibilities, and the objectives of Islamic law (Maqasid al-Shariah).</p>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="content-section">
        <div class="section-header">
            <h2>About Quran Explorer</h2>
            <p>Your comprehensive Islamic resource</p>
        </div>

        <div class="knowledge-card" style="max-width: 800px; margin: 0 auto;">
            <h3 class="knowledge-title">Our Mission</h3>
            <div class="knowledge-content">
                <p>Quran Explorer is dedicated to providing authentic Islamic knowledge and resources to Muslims and anyone interested in learning about Islam. We strive to make the Quran and Islamic teachings accessible to everyone through modern technology.</p>
                
                <h4 style="margin-top: 1.5rem; color: var(--primary);">Features</h4>
                <ul class="knowledge-list">
                    <li><i class="fas fa-check"></i> Complete Quran with multiple translations</li>
                    <li><i class="fas fa-check"></i> Audio recitations by renowned reciters</li>
                    <li><i class="fas fa-check"></i> Advanced playback controls (Play All, Pause, Stop, Repeat)</li>
                    <li><i class="fas fa-check"></i> Tafsir (exegesis) for deeper understanding</li>
                    <li><i class="fas fa-check"></i> Accurate prayer times with location detection</li>
                    <li><i class="fas fa-check"></i> Daily Duas and supplications</li>
                    <li><i class="fas fa-check"></i> Islamic knowledge and education</li>
                    <li><i class="fas fa-check"></i> User-friendly interface with dark mode</li>
                </ul>

                <h4 style="margin-top: 1.5rem; color: var(--primary);">Data Sources</h4>
                <p>Our Quranic data is sourced from reliable APIs including AlQuran Cloud API. Prayer times are provided by Aladhan API. We verify all content to ensure authenticity and accuracy.</p>

                <h4 style="margin-top: 1.5rem; color: var(--primary);">Contact & Feedback</h4>
                <p>We welcome your feedback and suggestions to improve Quran Explorer. If you find any issues or have ideas for new features, please let us know.</p>
            </div>
        </div>
    </section>

    <!-- Settings Panel -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-header">
            <h3>Settings</h3>
            <button class="control-btn" onclick="toggleSettings()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="settings-option">
            <label for="fontSize">Font Size</label>
            <select id="fontSize">
                <option value="small">Small</option>
                <option value="medium" selected>Medium</option>
                <option value="large">Large</option>
                <option value="x-large">X-Large</option>
            </select>
        </div>
        
        <div class="settings-option">
            <label for="arabicFont">Arabic Font</label>
            <select id="arabicFont">
                <option value="Noto Naskh Arabic" selected>Noto Naskh Arabic</option>
                <option value="Amiri">Amiri</option>
                <option value="Scheherazade">Scheherazade</option>
                <option value="Lateef">Lateef</option>
            </select>
        </div>
        
        <div class="settings-option">
            <label for="calculationMethod">Prayer Calculation</label>
            <select id="calculationMethod">
                <option value="1">Muslim World League</option>
                <option value="2">Islamic Society of North America</option>
                <option value="3">Egyptian General Authority</option>
                <option value="4">Umm Al-Qura University, Makkah</option>
                <option value="5">University of Islamic Sciences, Karachi</option>
                <option value="7">Institute of Geophysics, University of Tehran</option>
            </select>
        </div>
        
        <div class="settings-option">
            <label for="autoPlay">Auto Play Next Ayah</label>
            <select id="autoPlay">
                <option value="true">Yes</option>
                <option value="false" selected>No</option>
            </select>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Action completed successfully</span>
    </div>

    <div class="floating-icon" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </div>

    <div class="footer">
        <p>Quran Explorer • Complete Islamic Resource • Made with ❤️ for the Ummah</p>
        <p>© 2023 Quran Explorer Project • Data from AlQuran Cloud API & Aladhan API</p>
    </div>

    <script>
        // Global variables
        let allSurahs = [];
        let currentSurah = null;
        let currentReciter = 'ar.alafasy';
        let prayerTimesData = null;
        let countdownInterval = null;
        let userLocation = null;
        
        // Audio Playback System
        let currentAudio = null;
        let isPlaying = false;
        let isRepeating = false;
        let currentAyahIndex = 0;
        let currentSurahData = null;
        let audioElements = [];
        let progressInterval = null;

        // Dua data - Expanded with more authentic duas
        const duas = [
            // ... (same dua data as before)
            {
                id: 1,
                title: "Dua for Entering the House",
                arabic: "بِسْمِ اللهِ وَلَجْنَا، وَبِسْمِ اللهِ خَرَجْنَا، وَعَلَى رَبِّنَا تَوَكَّلْنَا",
                translation: "In the name of Allah we enter, in the name of Allah we leave, and upon our Lord we rely",
                reference: "Abu Dawud 4/325",
                category: "Daily Duas"
            },
            // ... (rest of the duas)
        ];

        // Group duas by category
        const duasByCategory = {};
        duas.forEach(dua => {
            if (!duasByCategory[dua.category]) {
                duasByCategory[dua.category] = [];
            }
            duasByCategory[dua.category].push(dua);
        });

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadSurahs();
            loadDuas();
            loadPrayerTimes();
            
            // Set up event listeners
            document.getElementById('surahSearch').addEventListener('input', filterSurahs);
            document.getElementById('duaSearch').addEventListener('input', filterDuas);
            document.getElementById('reciterSelector').addEventListener('change', function() {
                currentReciter = this.value;
                if (currentSurahData) {
                    // Reload audio sources if surah is loaded
                    updateAudioSources();
                }
            });

            // Volume control
            document.getElementById('volumeSlider').addEventListener('input', function() {
                if (currentAudio) {
                    currentAudio.volume = this.value;
                }
            });

            // Repeat button
            document.getElementById('repeatBtn').addEventListener('click', toggleRepeat);

            // Load settings
            loadSettings();

            // Check for saved theme preference
            if (localStorage.getItem('quranExplorerDark') === 'true') {
                document.body.classList.add('dark');
            }
        });

        // AUDIO PLAYBACK SYSTEM
        function playEntireSurah() {
            if (!currentSurahData) {
                showToast('Please select a surah first', 'error');
                return;
            }

            stopPlayback();
            currentAyahIndex = 0;
            playNextAyah();
        }

        function playNextAyah() {
            if (!currentSurahData || currentAyahIndex >= currentSurahData.ayahs.length) {
                if (isRepeating && currentSurahData) {
                    // Repeat the surah
                    currentAyahIndex = 0;
                    playNextAyah();
                } else {
                    stopPlayback();
                    showToast('Surah playback completed', 'success');
                }
                return;
            }

            const ayah = currentSurahData.ayahs[currentAyahIndex];
            playSingleAyah(ayah, currentAyahIndex);
            currentAyahIndex++;
        }

        function playSingleAyah(ayah, index) {
            stopPlayback();

            // Create new audio element
            currentAudio = new Audio(`https://cdn.islamic.network/quran/audio/128/${currentReciter}/${ayah.number}.mp3`);
            currentAudio.volume = document.getElementById('volumeSlider').value;

            // Update player UI
            updatePlayerUI(ayah, index);
            showGlobalPlayer();

            // Play the audio
            currentAudio.play();
            isPlaying = true;
            updatePlayPauseButtons();

            // Set up event listeners for this audio
            currentAudio.addEventListener('loadedmetadata', function() {
                updateDurationDisplay();
            });

            currentAudio.addEventListener('timeupdate', updateProgress);
            currentAudio.addEventListener('ended', function() {
                if (document.getElementById('autoPlay').value === 'true' || isRepeating) {
                    playNextAyah();
                } else {
                    stopPlayback();
                }
            });

            // Start progress updater
            progressInterval = setInterval(updateProgress, 1000);

            // Highlight current playing ayah
            highlightCurrentAyah(index);
        }

        function pausePlayback() {
            if (currentAudio && isPlaying) {
                currentAudio.pause();
                isPlaying = false;
                updatePlayPauseButtons();
            }
        }

        function resumePlayback() {
            if (currentAudio && !isPlaying) {
                currentAudio.play();
                isPlaying = true;
                updatePlayPauseButtons();
            }
        }

        function stopPlayback() {
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
                currentAudio = null;
            }
            isPlaying = false;
            clearInterval(progressInterval);
            updatePlayPauseButtons();
            resetProgress();
            removeAyahHighlight();
        }

        function toggleRepeat() {
            isRepeating = !isRepeating;
            const repeatBtn = document.getElementById('repeatBtn');
            const repeatControlBtn = document.getElementById('repeatControlBtn');
            
            if (isRepeating) {
                repeatBtn.classList.add('active');
                repeatControlBtn.classList.add('active');
                repeatControlBtn.innerHTML = '<i class="fas fa-redo"></i> Repeat: On';
                showToast('Repeat mode enabled', 'success');
            } else {
                repeatBtn.classList.remove('active');
                repeatControlBtn.classList.remove('active');
                repeatControlBtn.innerHTML = '<i class="fas fa-redo"></i> Repeat: Off';
                showToast('Repeat mode disabled', 'success');
            }
        }

        function updatePlayerUI(ayah, index) {
            document.getElementById('playerSurahName').textContent = 
                `${currentSurahData.englishName} (${currentSurahData.name})`;
            document.getElementById('playerAyahInfo').textContent = 
                `Ayah ${index + 1} of ${currentSurahData.ayahs.length}`;
        }

        function updateProgress() {
            if (currentAudio && currentAudio.duration) {
                const progress = (currentAudio.currentTime / currentAudio.duration) * 100;
                document.getElementById('progressFill').style.width = `${progress}%`;
                
                // Update time displays
                document.getElementById('currentTime').textContent = formatTime(currentAudio.currentTime);
                document.getElementById('durationTime').textContent = formatTime(currentAudio.duration);
            }
        }

        function resetProgress() {
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('currentTime').textContent = '0:00';
            document.getElementById('durationTime').textContent = '0:00';
        }

        function updateDurationDisplay() {
            if (currentAudio && currentAudio.duration) {
                document.getElementById('durationTime').textContent = formatTime(currentAudio.duration);
            }
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }

        function updatePlayPauseButtons() {
            const playBtn = document.getElementById('playBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            const pauseAllBtn = document.getElementById('pauseAllBtn');

            if (isPlaying) {
                playBtn.style.display = 'none';
                pauseBtn.style.display = 'flex';
                pauseAllBtn.innerHTML = '<i class="fas fa-pause"></i> Pause';
            } else {
                playBtn.style.display = 'flex';
                pauseBtn.style.display = 'none';
                pauseAllBtn.innerHTML = '<i class="fas fa-play"></i> Play';
            }
        }

        function showGlobalPlayer() {
            document.getElementById('globalAudioPlayer').classList.add('show');
        }

        function hideGlobalPlayer() {
            document.getElementById('globalAudioPlayer').classList.remove('show');
        }

        function seekAudio(event) {
            if (currentAudio && currentAudio.duration) {
                const progressBar = event.currentTarget;
                const clickPosition = event.offsetX;
                const progressBarWidth = progressBar.offsetWidth;
                const seekTime = (clickPosition / progressBarWidth) * currentAudio.duration;
                
                currentAudio.currentTime = seekTime;
                updateProgress();
            }
        }

        function highlightCurrentAyah(index) {
            // Remove previous highlights
            removeAyahHighlight();
            
            // Add highlight to current ayah
            const ayahCards = document.querySelectorAll('.ayah-card');
            if (ayahCards[index]) {
                ayahCards[index].classList.add('current-playing');
                
                // Scroll to current ayah
                ayahCards[index].scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center' 
                });
            }
        }

        function removeAyahHighlight() {
            document.querySelectorAll('.ayah-card').forEach(card => {
                card.classList.remove('current-playing');
            });
        }

        function updateAudioSources() {
            if (currentSurahData) {
                // Update all audio elements with new reciter
                const audioElements = document.querySelectorAll('audio');
                audioElements.forEach((audio, index) => {
                    const ayah = currentSurahData.ayahs[index];
                    if (ayah) {
                        audio.innerHTML = `
                            <source src="https://cdn.islamic.network/quran/audio/128/${currentReciter}/${ayah.number}.mp3">
                            Your browser does not support the audio element.
                        `;
                    }
                });
            }
        }

        // ... (rest of the existing functions for navigation, surah loading, prayer times, etc.)

        // Section navigation
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');

            // If prayer times section is shown, refresh prayer times
            if (sectionId === 'prayer-times') {
                refreshPrayerTimes();
            }
        }

        // Load and display surahs
        async function loadSurahs() {
            try {
                const response = await fetch('https://api.alquran.cloud/v1/surah');
                const data = await response.json();
                allSurahs = data.data;
                displaySurahs(allSurahs);
            } catch (error) {
                document.getElementById('surahGrid').innerHTML = `
                    <div class="knowledge-card" style="grid-column: 1 / -1; text-align: center;">
                        <h3>Error Loading Surahs</h3>
                        <p>Please check your internet connection and try again.</p>
                    </div>
                `;
            }
        }

        function displaySurahs(surahs) {
            const grid = document.getElementById('surahGrid');
            grid.innerHTML = '';
            
            surahs.forEach(surah => {
                const card = document.createElement('div');
                card.className = 'surah-card';
                card.innerHTML = `
                    <div class="surah-number">${surah.number}</div>
                    <h3 class="surah-name">${surah.englishName}</h3>
                    <div class="surah-name-arabic">${surah.name}</div>
                    <p>${surah.englishNameTranslation}</p>
                    <div class="surah-meta">
                        <span>${surah.revelationType}</span>
                        <span>${surah.numberOfAyahs} verses</span>
                    </div>
                `;
                card.addEventListener('click', () => loadSurahDetail(surah.number));
                grid.appendChild(card);
            });
        }

        function filterSurahs() {
            const searchTerm = document.getElementById('surahSearch').value.toLowerCase();
            const filtered = allSurahs.filter(surah => 
                surah.englishName.toLowerCase().includes(searchTerm) ||
                surah.name.toLowerCase().includes(searchTerm) ||
                surah.englishNameTranslation.toLowerCase().includes(searchTerm)
            );
            displaySurahs(filtered);
        }

        // Load detailed surah view
        async function loadSurahDetail(surahNumber) {
            try {
                document.getElementById('surahGrid').style.display = 'none';
                const detailContainer = document.getElementById('surahDetail');
                detailContainer.style.display = 'block';
                detailContainer.innerHTML = '<div class="loading">Loading surah... <span class="loading-spinner"></span></div>';
                
                const [arabicResponse, translationResponse] = await Promise.all([
                    fetch(`https://api.alquran.cloud/v1/surah/${surahNumber}`),
                    fetch(`https://api.alquran.cloud/v1/surah/${surahNumber}/en.asad`)
                ]);
                
                const arabicData = await arabicResponse.json();
                const translationData = await translationResponse.json();
                
                const surah = arabicData.data;
                currentSurah = surah;
                currentSurahData = surah; // Store for playback
                
                let html = `
                    <div class="section-header">
                        <h2>${surah.englishName} (${surah.name})</h2>
                        <p>${surah.englishNameTranslation} • ${surah.revelationType} • ${surah.numberOfAyahs} verses</p>
                        <button class="control-btn" onclick="backToSurahList()" style="margin-top: 1rem;">
                            <i class="fas fa-arrow-left"></i> Back to Surah List
                        </button>
                    </div>
                `;
                
                for (let i = 0; i < surah.ayahs.length; i++) {
                    const ayah = surah.ayahs[i];
                    const translation = translationData.data.ayahs[i].text;
                    
                    html += `
                        <div class="ayah-card" id="ayah-${i}">
                            <div class="ayah-number">${ayah.numberInSurah}</div>
                            <div class="ayah-controls">
                                <button class="ayah-control-btn" onclick="playSingleAyah(currentSurahData.ayahs[${i}], ${i})">
                                    <i class="fas fa-play"></i> Play This Ayah
                                </button>
                                <button class="ayah-control-btn" onclick="playFromHere(${i})">
                                    <i class="fas fa-forward"></i> Play From Here
                                </button>
                            </div>
                            <div class="ayah">${ayah.text}</div>
                            <div class="translation">${translation}</div>
                            <audio controls>
                                <source src="https://cdn.islamic.network/quran/audio/128/${currentReciter}/${ayah.number}.mp3">
                            </audio>
                            
                            <div class="tafsir-container">
                                <div class="tafsir-header" onclick="toggleTafsir(${ayah.number})">
                                    <span><i class="fas fa-book"></i> Tafsir (Exegesis)</span>
                                    <i class="fas fa-chevron-down tafsir-toggle" id="tafsir-toggle-${ayah.number}"></i>
                                </div>
                                <div class="tafsir-content" id="tafsir-content-${ayah.number}">
                                    <div class="loading">Loading tafsir... <span class="loading-spinner"></span></div>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                detailContainer.innerHTML = html;
                
                // Load tafsir in background
                for (let i = 0; i < surah.ayahs.length; i++) {
                    loadTafsir(surah.ayahs[i].number);
                }
                
            } catch (error) {
                document.getElementById('surahDetail').innerHTML = `
                    <div class="knowledge-card" style="text-align: center;">
                        <h3>Error Loading Surah</h3>
                        <p>Please try again or select another surah.</p>
                        <button class="control-btn" onclick="backToSurahList()" style="margin-top: 1rem;">
                            <i class="fas fa-arrow-left"></i> Back to Surah List
                        </button>
                    </div>
                `;
            }
        }

        function playFromHere(startIndex) {
            if (!currentSurahData) return;
            
            stopPlayback();
            currentAyahIndex = startIndex;
            playNextAyah();
        }

        function backToSurahList() {
            stopPlayback();
            document.getElementById('surahDetail').style.display = 'none';
            document.getElementById('surahGrid').style.display = 'grid';
            currentSurahData = null;
        }

        // Load tafsir for a specific ayah
        async function loadTafsir(ayahNumber) {
            try {
                const response = await fetch(`https://api.quran.com/api/v4/tafsirs?verse_key=${currentSurah.number}:${ayahNumber}&tafsir_id=169`);
                const data = await response.json();
                
                if (data.tafsirs && data.tafsirs.length > 0) {
                    const tafsirContent = document.getElementById(`tafsir-content-${ayahNumber}`);
                    if (tafsirContent) {
                        tafsirContent.innerHTML = `<p>${data.tafsirs[0].text}</p>`;
                    }
                } else {
                    throw new Error('Tafsir not available');
                }
            } catch (error) {
                const tafsirContent = document.getElementById(`tafsir-content-${ayahNumber}`);
                if (tafsirContent) {
                    tafsirContent.innerHTML = '<p>Tafsir not available for this verse.</p>';
                }
            }
        }

        // Toggle tafsir visibility
        function toggleTafsir(ayahNumber) {
            const content = document.getElementById(`tafsir-content-${ayahNumber}`);
            const toggleIcon = document.getElementById(`tafsir-toggle-${ayahNumber}`);
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                toggleIcon.classList.remove('expanded');
            } else {
                content.classList.add('expanded');
                toggleIcon.classList.add('expanded');
            }
        }

        // ... (rest of the prayer times functions and other existing functionality)

        // Utility functions
        function toggleNightMode() {
            const isDark = document.body.classList.toggle('dark');
            localStorage.setItem('quranExplorerDark', isDark);
            showToast(`Night mode ${isDark ? 'enabled' : 'disabled'}`, 'success');
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function toggleSettings() {
            document.getElementById('settingsPanel').classList.toggle('open');
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text)
                .then(() => {
                    showToast('Text copied to clipboard!', 'success');
                })
                .catch(err => {
                    console.error('Failed to copy: ', err);
                    showToast('Failed to copy text', 'error');
                });
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Settings functions
        function loadSettings() {
            const fontSize = localStorage.getItem('quranExplorerFontSize') || 'medium';
            const arabicFont = localStorage.getItem('quranExplorerArabicFont') || 'Noto Naskh Arabic';
            const calculationMethod = localStorage.getItem('quranExplorerCalculationMethod') || '2';
            const autoPlay = localStorage.getItem('quranExplorerAutoPlay') || 'false';
            
            document.getElementById('fontSize').value = fontSize;
            document.getElementById('arabicFont').value = arabicFont;
            document.getElementById('calculationMethod').value = calculationMethod;
            document.getElementById('autoPlay').value = autoPlay;
            
            applyFontSize(fontSize);
            applyArabicFont(arabicFont);
        }

        function applyFontSize(size) {
            const sizes = {
                'small': '0.9rem',
                'medium': '1rem',
                'large': '1.1rem',
                'x-large': '1.2rem'
            };
            
            document.body.style.fontSize = sizes[size];
        }

        function applyArabicFont(font) {
            document.querySelectorAll('.ayah, .dua-arabic, .surah-name-arabic').forEach(el => {
                el.style.fontFamily = font;
            });
        }

        // Save settings when changed
        document.getElementById('fontSize').addEventListener('change', function() {
            localStorage.setItem('quranExplorerFontSize', this.value);
            applyFontSize(this.value);
        });

        document.getElementById('arabicFont').addEventListener('change', function() {
            localStorage.setItem('quranExplorerArabicFont', this.value);
            applyArabicFont(this.value);
        });

        document.getElementById('calculationMethod').addEventListener('change', function() {
            localStorage.setItem('quranExplorerCalculationMethod', this.value);
            if (userLocation) {
                fetchPrayerTimes(userLocation.lat, userLocation.lng);
                showToast('Prayer calculation method updated', 'success');
            }
        });

        document.getElementById('autoPlay').addEventListener('change', function() {
            localStorage.setItem('quranExplorerAutoPlay', this.value);
        });

        // ... (prayer times functions would continue here)
    </script>
</body>
</html>
